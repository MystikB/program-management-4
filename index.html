<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PgMP Practice Quiz 5</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <style>
    :root { color-scheme: light; }
    .prose-ish p { margin: 0.35rem 0; }
    .ring-soft { box-shadow: 0 0 0 1px rgba(148,163,184,.5); }
    .mono { font-variant-numeric: tabular-nums; font-feature-settings: "tnum" 1; }
    .no-print { }
    @media print {
      .no-print { display: none !important; }
      body { background: white !important; }
      .print-break { break-inside: avoid; }
    }
  </style>
</head>
<body class="min-h-screen bg-slate-50 text-slate-900">
  <header class="sticky top-0 z-20 border-b bg-white/90 backdrop-blur">
    <div class="mx-auto flex max-w-6xl items-center justify-between gap-4 px-4 py-3">
      <div class="min-w-0">
        <h1 class="truncate text-lg font-semibold">PgMP Practice Quiz 5</h1>
        <p class="truncate text-xs text-slate-600">Choose the best answer for each question. Submit to grade and review explanations.</p>
      </div>
      <div class="no-print flex items-center gap-2">
        <div id="timerPill" class="hidden items-center gap-2 rounded-full bg-slate-900 px-3 py-1 text-sm text-white mono">
          <span class="text-slate-200">Time</span>
          <span id="timer">--:--</span>
        </div>
        <button id="pauseBtn" disabled class="rounded-lg bg-slate-900 px-3 py-2 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-50 hover:bg-black">Pause</button>
        <button id="add1Btn" disabled class="rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 disabled:cursor-not-allowed disabled:opacity-50 hover:bg-slate-200">+1 min</button>
        <button id="add5Btn" disabled class="rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 disabled:cursor-not-allowed disabled:opacity-50 hover:bg-slate-200">+5 min</button>
        <button id="startBtn" class="rounded-lg bg-indigo-600 px-3 py-2 text-sm font-semibold text-white hover:bg-indigo-700">Start</button>
        <button id="submitBtn" disabled class="rounded-lg bg-emerald-600 px-3 py-2 text-sm font-semibold text-white disabled:cursor-not-allowed disabled:opacity-50 hover:bg-emerald-700">Submit</button>
        <button id="resetBtn" class="rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-200">Reset</button>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-6xl px-4 py-6">
    <section id="intro" class="rounded-2xl bg-white p-6 ring-soft">
      <div class="flex flex-col gap-4 md:flex-row md:items-start md:justify-between">
        <div class="max-w-3xl">
          <h2 class="text-xl font-semibold">Instructions</h2>
          <div class="mt-2 text-sm text-slate-700 prose-ish">
            <p><span class="font-semibold">Questions:</span> <span id="qCount">0</span> (single-best-answer MCQ)</p>
            <p><span class="font-semibold">Timer:</span> Choose your duration and press <span class="font-semibold">Start</span>.</p>
            <p>When time expires, the quiz auto-submits and shows corrections and explanations.</p>
          </div>
        </div>
        <div class="no-print w-full md:w-80">
          <label class="block text-sm font-semibold text-slate-800">Timer duration</label>
          <div class="mt-2 grid grid-cols-3 gap-2">
            <button data-min="5" class="durBtn rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-200">5 min</button>
            <button data-min="10" class="durBtn rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-200">10 min</button>
            <button data-min="15" class="durBtn rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-200">15 min</button>
            <button data-min="30" class="durBtn rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-200">30 min</button>
            <button data-min="45" class="durBtn rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-200">45 min</button>
            <button data-min="60" class="durBtn rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-200">60 min</button>
          </div>
          <div class="mt-2">
            <label class="block text-xs font-medium text-slate-600">Custom (minutes)</label>
            <div class="mt-1 flex gap-2">
              <input id="customMin" type="number" min="1" value="45" class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none" />
              <button id="applyCustom" class="rounded-lg bg-slate-900 px-3 py-2 text-sm font-semibold text-white hover:bg-black">Apply</button>
            </div>
          </div>
          <div class="mt-4 rounded-xl bg-indigo-50 p-3 text-xs text-indigo-900">
            Tip: You can <span class="font-semibold">print</span> your results after submission.
          </div>
        </div>
      </div>
    </section>

    <section id="status" class="mt-6 hidden rounded-2xl bg-white p-6 ring-soft">
      <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
        <div>
          <h2 class="text-xl font-semibold">Results</h2>
          <p class="mt-1 text-sm text-slate-700">Your score and corrections are shown below.</p>
        </div>
        <div class="grid grid-cols-2 gap-3 md:grid-cols-4">
          <div class="rounded-xl bg-slate-50 p-3">
            <div class="text-xs text-slate-600">Score</div>
            <div class="text-lg font-semibold"><span id="score">0</span>/<span id="total">0</span></div>
          </div>
          <div class="rounded-xl bg-slate-50 p-3">
            <div class="text-xs text-slate-600">Grade</div>
            <div class="text-lg font-semibold"><span id="grade">0%</span></div>
          </div>
          <div class="rounded-xl bg-slate-50 p-3">
            <div class="text-xs text-slate-600">Answered</div>
            <div class="text-lg font-semibold"><span id="answered">0</span></div>
          </div>
          <div class="rounded-xl bg-slate-50 p-3">
            <div class="text-xs text-slate-600">Time used</div>
            <div class="text-lg font-semibold mono"><span id="timeUsed">--:--</span></div>
          </div>
        </div>
      </div>
    </section>

    <section class="mt-6">
      <div class="no-print flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
        <div class="flex items-center gap-2">
          <input id="onlyIncorrect" type="checkbox" class="h-4 w-4" />
          <label for="onlyIncorrect" class="text-sm text-slate-700">Show only incorrect/unanswered</label>
        </div>
        <div class="flex flex-col gap-2 md:flex-row md:items-center">
          <div class="relative">
            <input id="search" type="search" placeholder="Search questions..." class="w-full md:w-96 rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none" />
          </div>
          <button id="expandAll" class="no-print rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-200">Expand explanations</button>
          <button id="collapseAll" class="no-print rounded-lg bg-slate-100 px-3 py-2 text-sm font-semibold text-slate-900 hover:bg-slate-200">Collapse explanations</button>
        </div>
      </div>

      <div id="quiz" class="mt-4 grid gap-4"></div>

      <div class="no-print mt-6 flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
        <div class="text-xs text-slate-600">Auto-save: your selections are stored in your browser until you reset.</div>
        <div class="flex gap-2">
          <button id="scrollTop" class="rounded-lg bg-slate-900 px-3 py-2 text-sm font-semibold text-white hover:bg-black">Back to top</button>
          <button id="printBtn" class="rounded-lg bg-indigo-600 px-3 py-2 text-sm font-semibold text-white hover:bg-indigo-700">Print results</button>
        </div>
      </div>
    </section>
  </main>

  <script>
    // NOTE: Built from the user-provided "Advanced exam2 - Results Attempt 2" content.
    // Some explanations were condensed for readability but keep the essential rationale.

    const QUIZ_ID = 'pgmp_practice_quiz_5_v1';

    /**
     * Each question: {id, q, options:[{k,text}], answer:'A'|'B'|'C'|'D', explanation}
     *
     * IMPORTANT: The source text indicates three incorrect attempts (Q36, Q59, Q63, Q86, Q89).
     * Correct answers were explicitly shown there. All others were marked correct.
     */
    const questions = [
      {id:1,q:"You are a program manager ... initial step needed to evaluate alignment of available resources with needs of the program?",options:[
        {k:'A',text:'Identifying the program resource requirements.'},
        {k:'B',text:'Assessment of skills and competencies.'},
        {k:'C',text:'Contact the functional department manager to get information about the available resources.'},
        {k:'D',text:'Develop the program resource management plan.'}
      ],answer:'B',explanation:"Estimate required resources (esp. staff/facilities) early; assess skills/competencies to align needs vs availability. (Standard for Program Management p.109)."},
      {id:2,q:"A program is near completion... who is accountable for managing benefits after closure. What action should the sponsor take?",options:[
        {k:'A',text:'Request the program manager to develop the plans required for transition and sustain the benefits after the program closure.'},
        {k:'B',text:'Request the operations manager to develop the plans required for transition and sustain the benefits after the program closure.'},
        {k:'C',text:'Ask the program manager to assign a program team member to ensure that the benefits and knowledge have been transitioned to the process area.'},
        {k:'D',text:'Ask the operations manager to assign an operation team member to ensure that the benefits and knowledge have been transitioned to the process area.'}
      ],answer:'A',explanation:"Sponsor ensures transition & sustainment planning exists: transition plan to operations and sustainment plan for benefits beyond program completion (ECO Domain 3 tasks)."},
      {id:3,q:"Different project managers prefer different progress report templates. What should you do to select one template for all projects?",options:[
        {k:'A',text:'Review the issue with the project managers for reaching to an agreement on which template to use.'},
        {k:'B',text:'Discuss the matter with the program PMO to determine which template is appropriate to use.'},
        {k:'C',text:'Escalate the issue program steering committee to select the template.'},
        {k:'D',text:'Ask the project managers to use any report templates they like.'}
      ],answer:'B',explanation:"PMO defines standards, tools, and procedures and supports communications; use PMO standards for uniform reporting (Standard p.20 & p.85)."},
      {id:4,q:"Conflicting stakeholder demands: team high interest in schedule/cost but low in quality/benefits; client high interest in benefits. What should you do?",options:[
        {k:'A',text:'Follow the team members to finish on time/within budget.'},
        {k:'B',text:'Follow the client organization to achieve the intended benefits.'},
        {k:'C',text:'Meet with stakeholders to allow everyone to state their priorities.'},
        {k:'D',text:'Balance stakeholder needs by using trade-offs among stakeholder groups.'}
      ],answer:'D',explanation:"Balance stakeholder interests using trade-offs; external stakeholders may have strong influence; consider impacts on benefits realization (Standard p.57)."},
      {id:5,q:"Definition phase; using external suppliers. What should you use to determine/document results of procurement planning activity?",options:[
        {k:'A',text:'RFB, RFPs, RFQ, alternatives analyses, approach to competition.'},
        {k:'B',text:'RFP, proposal evaluation criteria, contract management,'},
        {k:'C',text:'Make-or-buy decisions, contract management, and RFQ.'},
        {k:'D',text:'Alternatives analyses, Make-or-buy decisions, the best mix of contract types, and approach to competition.'}
      ],answer:'D',explanation:"In definition/planning: analyze alternatives, make-or-buy, program-wide contract-type mix, and competition approach (Standard p.117). RFP/RFQ are later outputs."},
      {id:6,q:"Supplier history of overestimating planned values. What should you do to monitor/control supplier?",options:[
        {k:'A',text:'Use expert judgment, and update the procurement plan.'},
        {k:'B',text:'Review performance reports, inspections, and audits.'},
        {k:'C',text:'Ask the CEO and stakeholder for approval.'},
        {k:'D',text:'Review evaluation criteria, analyze risks and response strategies.'}
      ],answer:'B',explanation:"Control procurements uses performance reviews/reports, inspections, and audits (PMBOK6 p.492)."},
      {id:7,q:"Sponsor identified a critical schedule risk in a meeting. What should you do next?",options:[
        {k:'A',text:'Implement the risk response plan for the identified risk.'},
        {k:'B',text:'Document the risk in the register and create a mitigation response plan.'},
        {k:'C',text:'Update the program risk and benefits management plan.'},
        {k:'D',text:'Cancel the program to avoid the risk.'}
      ],answer:'B',explanation:"First document identified risk in risk register, analyze, and develop response; don’t implement before registering/analyzing."},
      {id:8,q:"Org strategy alignment meeting reveals another program developing new tech improving ops performance/cost. What should you do to add to your program?",options:[
        {k:'A',text:'Add the new technology to the sustainment plan.'},
        {k:'B',text:'Meet component managers to update risk register using NPV.'},
        {k:'C',text:'Update benefits management plan with benefits of new tech.'},
        {k:'D',text:'Analyze the benefits management plan to identify new risks that may arise due to this new technology.'}
      ],answer:'D',explanation:"Analyze then update: review benefits plans for new uncertainty/risks/opportunities before changes (ECO Domain 3 Task 7)."},
      {id:9,q:"In which phase is the program risk management plan created?",options:[
        {k:'A',text:'Program risk management planning activity.'},
        {k:'B',text:'Program definition.'},
        {k:'C',text:'Transition phase.'},
        {k:'D',text:'Program delivery phase.'}
      ],answer:'B',explanation:"Risk management planning activity occurs early in program definition; outputs include program risk management plan and risk register (Standard p.120)."},
      {id:10,q:"Execution phase; stakeholder didn’t receive critical communication about project X. What should you do?",options:[
        {k:'A',text:'Review and revise the stakeholder engagement plan.'},
        {k:'B',text:'Review and update the detailed stakeholder list.'},
        {k:'C',text:'Conduct the component communications management plan.'},
        {k:'D',text:'Add the risk to the program risk register.'}
      ],answer:'A',explanation:"Stakeholder engagement plan defines engagement strategy and metrics; revise it to address gaps (Standard p.64)."},
      {id:11,q:"Sponsor says some stakeholders may not understand benefits. What provides greatest value to clarify perceptions?",options:[
        {k:'A',text:'Send them the program charter.'},
        {k:'B',text:'Stakeholder analysis.'},
        {k:'C',text:'Update stakeholder communications requirements.'},
        {k:'D',text:'Send them the benefits management plan.'}
      ],answer:'D',explanation:"Benefits management plan defines benefits, KPIs, roles, transition/sustainment; best artifact to clarify benefit understanding."},
      {id:12,q:"Scope and schedule met but quality low, cost/resources too high; benefits unattainable; ROI unacceptable. What should you do?",options:[
        {k:'A',text:'Request additional funds.'},
        {k:'B',text:'Request extension for the schedule.'},
        {k:'C',text:'Transition existing results to operations.'},
        {k:'D',text:'Ask for program cancellation based on performance indicators and metrics.'}
      ],answer:'D',explanation:"If benefits cannot be achieved and business case no longer valid, recommend termination to governance (Standard p.102)."},
      {id:13,q:"Program near completion; all benefits delivered; exec concerned about long-term benefits realization. What ensures long-term realization?",options:[
        {k:'A',text:'Risk management plan.'},
        {k:'B',text:'Benefits indication.'},
        {k:'C',text:'Benefits sustainment plan'},
        {k:'D',text:'Benefits transition plan'}
      ],answer:'C',explanation:"Sustainment plan identifies processes/metrics/tools and risks to maintain benefits beyond program end (Standard p.55)."},
      {id:14,q:"Take over program; what should you review to assess cost and benefits justifications?",options:[
        {k:'A',text:'Program risk management plan.'},
        {k:'B',text:'Program charter.'},
        {k:'C',text:'Program benefits management plan.'},
        {k:'D',text:'Program business case.'}
      ],answer:'D',explanation:"Business case is the primary justification and value declaration for resources spent (Standard p.35)."},
      {id:15,q:"Complex program; key stakeholders uninformed, not involved, don’t understand benefits. What should PM do?",options:[
        {k:'A',text:'Send progress report after next week’s status meeting.'},
        {k:'B',text:'Identify stakeholder expectations and update stakeholder engagement plan.'},
        {k:'C',text:'Revise communications management plan after discussion with governance board.'},
        {k:'D',text:'Meet with key stakeholders and update the program stakeholder map.'}
      ],answer:'D',explanation:"Stakeholder map visualizes influence/support and engagement needs in complex programs; update it after meeting stakeholders (Standard p.62-63)."},
      {id:16,q:"CEO mandates program; sponsor assigned; what should be elements of program charter?",options:[
        {k:'A',text:'Scope, justification, outcomes, and scope management plan.'},
        {k:'B',text:'Scope, justification, outcomes, and stakeholder considerations.'},
        {k:'C',text:'Scope, justification, outcomes, and procurement management plan.'},
        {k:'D',text:'Scope, justification, outcomes, and benefits management plan.'}
      ],answer:'B',explanation:"Charter contains high-level scope/justification/outcomes and stakeholder considerations—not management plans (Standard p.93)."},
      {id:17,q:"Program transitioned to receiving area; what can you obtain from post-review meeting?",options:[
        {k:'A',text:'Risk register updates.'},
        {k:'B',text:'Performance plan report.'},
        {k:'C',text:'Feedback and lessons learned.'},
        {k:'D',text:'Benefits register updates.'}
      ],answer:'C',explanation:"Post-review meeting presents performance report to obtain feedback and capture lessons learned (ECO Domain2 Task34)."},
      {id:18,q:"Phase gate review includes benefits tracking; which is a point in the review?",options:[
        {k:'A',text:'Ensure that the other requirements of the stage-gate have been met.'},
        {k:'B',text:'Monitoring and tracking on benefits plan.'},
        {k:'C',text:'Identify risks and benefits.'},
        {k:'D',text:'Meet stakeholders and collect expectations.'}
      ],answer:'A',explanation:"Phase-gate reviews verify exit/entry criteria for phases (Standard p.75)."},
      {id:19,q:"Program fails to achieve intended benefits; before closing program what should PM do?",options:[
        {k:'A',text:'Update the benefits management plan.'},
        {k:'B',text:'Establish the PMIS.'},
        {k:'C',text:'Hand over knowledge to deputy program manager.'},
        {k:'D',text:'Share the lessons learned with program teams.'}
      ],answer:'D',explanation:"If terminated, focus on capturing/sharing lessons learned for organizational learning (Standard p.102)."},
      {id:20,q:"Completed program; what can prevent starting program closure?",options:[
        {k:'A',text:'Failure to update the scope management plan.'},
        {k:'B',text:'Failure to get approval from the program governance board.'},
        {k:'C',text:'Failure to update the procurement management plan.'},
        {k:'D',text:'Failure to update the risk register.'}
      ],answer:'B',explanation:"Governance/steering committee must approve program closure recommendations (Standard p.78)."},
      {id:21,q:"Project risk due to interdependency exceeds thresholds. What should you do next?",options:[
        {k:'A',text:'Update the program roadmap to mitigate the risk.'},
        {k:'B',text:'Ask component manager to escalate to sponsor.'},
        {k:'C',text:'Incorporate the project risk into the program risk response strategy.'},
        {k:'D',text:'Ask PM to manage the risk at project level.'}
      ],answer:'C',explanation:"Interdependency risks affecting multiple components are escalated to program level and addressed in program risk strategy (Standard p.98)."},
      {id:22,q:"Risk manager says additional actions required to address all risks effectively. What should you do next?",options:[
        {k:'A',text:'Use the known risks.'},
        {k:'B',text:'Mitigate all project threats.'},
        {k:'C',text:'Establish a contingency reserve.'},
        {k:'D',text:'Use the schedule management plan.'}
      ],answer:'C',explanation:"Contingency reserve funds responses for identified risks, secondary/residual risks, and failed responses."},
      {id:23,q:"Conducting feasibility analysis for EMS program. What should you do next to complete?",options:[
        {k:'A',text:'Create the program mission.'},
        {k:'B',text:'Review strategic goals and objectives.'},
        {k:'C',text:'Link benefits to the EMS system.'},
        {k:'D',text:'Identify and document the initial risks for the EMS system.'}
      ],answer:'D',explanation:"Program formulation includes initial risk assessment alongside scope/resource/cost estimates and charter/roadmap (Standard p.92)."},
      {id:24,q:"Delivery phase: when should you approve the closure of a project in your program?",options:[
        {k:'A',text:'When the benefits have been delivered.'},
        {k:'B',text:'When meeting or exceeding the acceptance criteria of the project.'},
        {k:'C',text:'When deliverables of the program are complete.'},
        {k:'D',text:'When deliverables of the project are complete.'}
      ],answer:'B',explanation:"Component closure/transition occurs when its results meet acceptance criteria; then integrate/transition to operations (Standard p.97 & p.53)."},
      {id:25,q:"Writing program scope boundaries. Which captures program scope boundaries?",options:[
        {k:'A',text:'Program benefits management plan.'},
        {k:'B',text:'Program scope statement.'},
        {k:'C',text:'Program schedule management plan.'},
        {k:'D',text:'Program WBS.'}
      ],answer:'B',explanation:"Program scope statement defines boundaries and supports initial assessments (Standard p.110)."},
      {id:26,q:"Preparation of the program. What do you do to obtain formal sponsor approval to begin benefits delivery phase?",options:[
        {k:'A',text:'Develop the program charter.'},
        {k:'B',text:'Establish a high-level program roadmap of milestones.'},
        {k:'C',text:'Create the program management plan based on the organization\'s strategic plan.'},
        {k:'D',text:'Define the program benefits in the benefits management plan.'}
      ],answer:'C',explanation:"Delivery begins after program management plan is reviewed and formally approved by governance (Standard p.95)."},
      {id:27,q:"Cross-cultural team; varying delivery excellence. What should you do to achieve commitment and improve engagement?",options:[
        {k:'A',text:'Ask project managers to address the issue.'},
        {k:'B',text:'Invite them to a party.'},
        {k:'C',text:'Send email to all team members to deliver program objectives.'},
        {k:'D',text:'Use formal mentoring, coaching, and support program to handle cultural differences enabling collaboration.'}
      ],answer:'D',explanation:"Lead HR via training/coaching/mentoring to improve engagement and commitment (ECO Domain2 Task19)."},
      {id:28,q:"Charter approved. What should you do next as program manager?",options:[
        {k:'A',text:'Estimates for time, scope, resources, and cost.'},
        {k:'B',text:'Place a team to develop the program management plan.'},
        {k:'C',text:'Define program delivery and develop resource management plan.'},
        {k:'D',text:'Update the benefits management plan.'}
      ],answer:'B',explanation:"After charter approval, planning begins: establish governance, define initial org, assemble team to develop program management plan (Standard p.94)."},
      {id:29,q:"Opportunity adds value; sponsor approved scope change. Ensure results work in tandem with ______.",options:[
        {k:'A',text:'Critical success function (CSF)'},
        {k:'B',text:'KPIs'},
        {k:'C',text:'Stakeholders register.'},
        {k:'D',text:'Program benefits management plan.'}
      ],answer:'D',explanation:"New benefits/outcomes must be incorporated/validated against the benefits management plan (Standard p.49-50)."},
      {id:30,q:"Sponsor wants knowledge reused for future programs. What should you do to capture knowledge efficiently?",options:[
        {k:'A',text:'Document lessons learned in the program management plan.'},
        {k:'B',text:'Use review sessions after each program stage to document successes, issues, and lessons learned.'},
        {k:'C',text:'Document lessons learned in training documents.'},
        {k:'D',text:'Document lessons learned in event logs.'}
      ],answer:'B',explanation:"Update lessons learned database regularly (at stage completion and program end) to reuse knowledge (Standard p.130)."},
      {id:31,q:"Key stakeholder missed kickoff. What should you do to ensure he understands benefits and supports program?",options:[
        {k:'A',text:'Add expectations in charter and sustainment plan.'},
        {k:'B',text:'Meet with key stakeholder to ensure communication needs are in communications management plan and expectations of benefits are in benefits management plan.'},
        {k:'C',text:'Write a note in comms plan and document expectations in benefits plan.'},
        {k:'D',text:'Meet and document expectations in sustainment plan.'}
      ],answer:'B',explanation:"For key stakeholders, meet directly to capture comms needs and benefit expectations in the appropriate plans."},
      {id:32,q:"No procedure to manage suppliers; what should you do first to obtain program approval?",options:[
        {k:'A',text:'Create the stakeholder engagement plan.'},
        {k:'B',text:'Meet program team to identify/analyze stakeholders.'},
        {k:'C',text:'Project stakeholder analysis.'},
        {k:'D',text:'Analyze business environment to identify key stakeholders, then perform stakeholder analysis.'}
      ],answer:'D',explanation:"Early chartering: analyze environment and stakeholders before teams/projects exist (ECO Domain2 Task1)."},
      {id:33,q:"Org acquired another company and changed strategic objectives mid-benefits delivery. What should PM do next?",options:[
        {k:'A',text:'Add new acquisition into program immediately.'},
        {k:'B',text:'Assess impact via change request.'},
        {k:'C',text:'Assess impact on quality management plan.'},
        {k:'D',text:'Assess validity of the program by reviewing the benefits management plan.'}
      ],answer:'D',explanation:"Continuously evaluate delivered benefits vs expected benefits in benefits management plan to ensure strategic alignment (Standard p.52)."},
      {id:34,q:"Acquire company B with different billing system; CFO asks you to study and recommend best option. What should you do?",options:[
        {k:'A',text:'Search other companies and ask PMs to justify.'},
        {k:'B',text:'Determine resources needed and why it saves money.'},
        {k:'C',text:'Determine costs and benefits for each system and recommend appropriate solution with clarification why better.'},
        {k:'D',text:'Meet stakeholders to perform stakeholder analysis and develop program management plan.'}
      ],answer:'C',explanation:"Conduct impact/cost-benefit assessments for change decisions and recommend per governance model (ECO Domain2 Task29)."},
      {id:35,q:"Sponsor requests uniform plans/procedures/tech across program; increases cost; request comes 8 months in. What should PM do?",options:[
        {k:'A',text:'Implement changes.'},
        {k:'B',text:'Ignore request.'},
        {k:'C',text:'Meet stakeholders and component managers to discuss proposed changes then give sponsor best option.'},
        {k:'D',text:'Meet sponsor and present risks and benefits of changes.'}
      ],answer:'C',explanation:"Discuss with stakeholders/components to assess impacts/options, then advise sponsor with best program-wide approach."},
      {id:36,q:"International construction impacts local community; garden condition. Best approach for communications to ensure community support?",options:[
        {k:'A',text:'Meet sponsor and community reps to review program scope.'},
        {k:'B',text:'Arrange an advocacy group and facilitate community engagement.'},
        {k:'C',text:'Negotiate the program scope with community representatives.'},
        {k:'D',text:'Community reps should be part of the governance board.'}
      ],answer:'C',explanation:"Stakeholder engagement includes negotiating objectives/scope and securing support; negotiate scope with community to reach compromise (Standard p.58-60)."},
      {id:37,q:"Sponsor asks to accelerate program due to legacy system at risk of failure. What do you do next?",options:[
        {k:'A',text:'Accelerate immediately.'},
        {k:'B',text:'Perform impact analysis of accelerating and present pros/cons to sponsor.'},
        {k:'C',text:'Accelerate only required part if cost-effective then implement.'},
        {k:'D',text:'Use what-if scenarios and present.'}
      ],answer:'B',explanation:"Start with impact analysis and then seek approval; don’t accelerate without analysis."},
      {id:38,q:"Project X has comms plan; Project Y PM doesn’t know how. Ensure comms consistent?",options:[
        {k:'A',text:'Change PM of project Y.'},
        {k:'B',text:'Use project X plan as template.'},
        {k:'C',text:'You develop comms plans for all components.'},
        {k:'D',text:'Develop a program communications management plan across all component projects.'}
      ],answer:'D',explanation:"Program comms management plan sets overarching approach; component plans align with it."},
      {id:39,q:"What defines how program benefits will be transferred to operations?",options:[
        {k:'A',text:'Program transfer plan.'},
        {k:'B',text:'Program benefits transition plan.'},
        {k:'C',text:'Benefits transfer management plan.'},
        {k:'D',text:'Program change management plan.'}
      ],answer:'B',explanation:"Benefits transition phase ensures benefits are transitioned to operations and can be sustained (Standard p.53)."},
      {id:40,q:"Comms plan defines what/how to communicate. Which is input to information distribution process?",options:[
        {k:'A',text:'CCB.'},
        {k:'B',text:'EV.'},
        {k:'C',text:'Stakeholder analysis plan.'},
        {k:'D',text:'Performance reports.'}
      ],answer:'D',explanation:"Performance reports are key inputs to distribute program info and support governance/stakeholder engagement (Standard p.127)."},
      {id:41,q:"Risk escalated to program; low impact/probability but may impact other projects. What should you do first?",options:[
        {k:'A',text:'Ask for additional reserve from sponsor.'},
        {k:'B',text:'Document the risk details and analysis in the program risk register.'},
        {k:'C',text:'Ask PMs to manage risk at project level.'},
        {k:'D',text:'Meet with PM to develop risk response strategy.'}
      ],answer:'B',explanation:"First add escalated multi-component risk to program risk register with analysis; then determine response."},
      {id:42,q:"Take over large program; stakeholders upset due to lack of communications. What should you do first?",options:[
        {k:'A',text:'Review program management plan.'},
        {k:'B',text:'Review stakeholder engagement plan.'},
        {k:'C',text:'Escalate to sponsor.'},
        {k:'D',text:'Review communications management plan and stakeholder register.'}
      ],answer:'D',explanation:"Comms plan + stakeholder register specify who needs what information, when, and how (Standard p.112)."},
      {id:43,q:"Last month of execution; bonus depends on program success decision. How justify bonus upon closure?",options:[
        {k:'A',text:'Use customer satisfaction survey.'},
        {k:'B',text:'Update business case analysis doc indicating how each objective was attained.'},
        {k:'C',text:'Create a financial framework to align with metrics.'},
        {k:'D',text:'Present a report using the benefits management plan to clarify overall benefits realization.'}
      ],answer:'D',explanation:"Use benefits management plan to demonstrate benefits realized vs plan during delivery and at closure."},
      {id:44,q:"Establish direction and context/framework. Which supports this activity?",options:[
        {k:'A',text:'Program procurement management plan.'},
        {k:'B',text:'Program scope statement.'},
        {k:'C',text:'Program benefits management plan.'},
        {k:'D',text:'Program schedule.'}
      ],answer:'B',explanation:"Scope statement defines boundaries and what’s in/out at program level (Standard p.110)."},
      {id:45,q:"Sponsor requests accelerating new manufacturing process; may negatively affect program goals. What should you do?",options:[
        {k:'A',text:'Tell sponsor to follow plan unless CCB approves.'},
        {k:'B',text:'Implement fast-tracking and update resource plan.'},
        {k:'C',text:'Document concerns and present at next governance board review for guidance/actions.'},
        {k:'D',text:'Create KPIs to monitor benefits.'}
      ],answer:'C',explanation:"Escalate documented concerns to governance for direction; don’t implement changes without approval."},
      {id:46,q:"Two PMs schedule same scarce resource; program manager decides one project waits. What is this?",options:[
        {k:'A',text:'Resource interdependency management.'},
        {k:'B',text:'Program schedule management planning.'},
        {k:'C',text:'Program risk management planning.'},
        {k:'D',text:'Project procurement planning'}
      ],answer:'A',explanation:"Managing shared/scarce resources across components to avoid delays is resource interdependency management (Standard p.133)."},
      {id:47,q:"Client sees 50% planned but only 40% complete. What should you do to ensure benefits realization?",options:[
        {k:'A',text:'Escalate to PMO.'},
        {k:'B',text:'Conduct performance analysis and update business case.'},
        {k:'C',text:'Escalate to sponsor/steering.'},
        {k:'D',text:'Perform impact analysis of delay, review risks, identify corrective actions, and update benefits management plan.'}
      ],answer:'D',explanation:"Analyze schedule variance impacts and update benefits plan as needed to ensure benefits realization; don’t escalate without analysis."},
      {id:48,q:"Program performing well but stakeholders fear new processes won’t perform in current environment. What should you do?",options:[
        {k:'A',text:'Inform stakeholders new processes are better.'},
        {k:'B',text:'Meet stakeholders to ensure they understand expectations for new processes are superior to current processes.'},
        {k:'C',text:'Meet stakeholders and change processes delivered.'},
        {k:'D',text:'Advise governance board to motivate stakeholders.'}
      ],answer:'B',explanation:"Engage stakeholders to set expectations/acceptance criteria and maintain alignment (ECO Domain4 Task3)."},
      {id:49,q:"A successful resource used in project X may be used in Y. What should you do first to optimize utilization?",options:[
        {k:'A',text:'Transfer resource from X to Y.'},
        {k:'B',text:'Use in Y after completion of X.'},
        {k:'C',text:'Use another resource in X.'},
        {k:'D',text:'Resource prioritization to optimize use across both projects X and Y.'}
      ],answer:'D',explanation:"Resource prioritization optimizes scarce resources across components (Standard p.133)."},
      {id:50,q:"Influential stakeholder requests adding new technology immediately to increase benefits and accelerate schedule. What should you do next?",options:[
        {k:'A',text:'Submit a change request to implement new technology.'},
        {k:'B',text:'Tell stakeholder program will not be changed.'},
        {k:'C',text:'Assess the new technology and discuss results with governance board to determine next steps.'},
        {k:'D',text:'Study new technology and start implementation next phase.'}
      ],answer:'C',explanation:"Analyze first, then discuss with governance for decision; don’t refuse or implement without assessment/approval."},
      {id:51,q:"Plan to address negative variance and add red mark in status reports. What should you do?",options:[
        {k:'A',text:'Collect details, perform impact analysis, recommend corrective actions, and present results to steering committee for decision.'},
        {k:'B',text:'Meet project sponsors to get impact analysis of possible corrective actions.'},
        {k:'C',text:'Request additional funding from sponsor.'},
        {k:'D',text:'Ask program team to present results to steering committee.'}
      ],answer:'A',explanation:"Program manager owns analysis and recommendations to governance; team can help analyze but PM presents."},
      {id:52,q:"Org drafts new strategy (cloud). How use program mission to engage stakeholders?",options:[
        {k:'A',text:'Send mission statement to stakeholders to ensure support.'},
        {k:'B',text:'Update mission statement to address strategic goals and stakeholders’ concerns, interests, and expectations.'},
        {k:'C',text:'Document current state and how program will support mission.'},
        {k:'D',text:'Add key stakeholders and their influence into mission statement.'}
      ],answer:'B',explanation:"Mission should be defined/updated by evaluating stakeholders’ concerns and expectations to establish direction (ECO Domain1 Task4)."},
      {id:53,q:"During delivery, key stakeholder asks if program meets objectives. How demonstrate progress?",options:[
        {k:'A',text:'Submit additional performance reports.'},
        {k:'B',text:'Maintain the program benefits register and provide it to key stakeholder.'},
        {k:'C',text:'Submit program charter.'},
        {k:'D',text:'Identify/define KPIs to stakeholder.'}
      ],answer:'B',explanation:"Benefits register tracks planned benefits, KPIs/thresholds, status, dates; used to measure and communicate benefit delivery (Standard p.47)."},
      {id:54,q:"Planning phase; subcontractor incentives may conflict with program objectives. What should you do first?",options:[
        {k:'A',text:'Create a change request for governance approval.'},
        {k:'B',text:'Ask PMO.'},
        {k:'C',text:'Review the program charter, then update program objectives accordingly.'},
        {k:'D',text:'Review agreement, then create budget contingency.'}
      ],answer:'C',explanation:"First confirm/update objectives in charter through official channels before downstream actions."},
      {id:55,q:"Governance member asks you to select rejected vendor (relative). What should you do?",options:[
        {k:'A',text:'Select vendor immediately.'},
        {k:'B',text:'Start new bid process.'},
        {k:'C',text:'Add vendor to approved list.'},
        {k:'D',text:'Write an ethics violation.'}
      ],answer:'D',explanation:"Conflict of interest: follow PMI Code of Ethics; report ethics violation (Standard p.2)."},
      {id:56,q:"Benefit of structuring work into a program?",options:[
        {k:'A',text:'Coordinated practice of portfolio/program/project management (OPM).'},
        {k:'B',text:'Deliver initiatives by portfolios alignment.'},
        {k:'C',text:'Commitment to constraints to achieve activities.'},
        {k:'D',text:'Bundling components/work to gain efficiencies unachievable if managed individually.'}
      ],answer:'D',explanation:"Program delivers benefits/efficiencies not available from managing components individually (Standard p.3)."},
      {id:57,q:"Low-performance program not aligned with org goals; need realign components. What should you do?",options:[
        {k:'A',text:'Create change request for steering approval; cancel some projects, accelerate some, reassign resources.'},
        {k:'B',text:'Meet sponsor and follow decision.'},
        {k:'C',text:'Perform schedule assessment to maintain all components.'},
        {k:'D',text:'Meet stakeholders and follow their decision.'}
      ],answer:'A',explanation:"Realignment requires approved change request via governance; programs may cancel/start/redirect components (Standard p.28, p.136)."},
      {id:58,q:"Ensure benefits realized according to governance during execution. What do you do?",options:[
        {k:'A',text:'Update benefits register.'},
        {k:'B',text:'Ask steering committee.'},
        {k:'C',text:'Review the benefits management plan'},
        {k:'D',text:'Review the program business case.'}
      ],answer:'C',explanation:"During execution, regularly evaluate actual benefits vs expected benefits defined in benefits management plan (Standard p.52)."},
      {id:59,q:"CEO warns potential budget cuts; may require schedule acceleration. What should you do first?",options:[
        {k:'A',text:'Update benefits register and benefits management plan.'},
        {k:'B',text:'Perform a risk assessment related to schedule acceleration, update risk register, and request approval from steering committee.'},
        {k:'C',text:'Record impact then meet steering committee to determine next step.'},
        {k:'D',text:'Update schedule and submit for approval.'}
      ],answer:'B',explanation:"Conduct impact/risk assessment for program changes, update risk register, and recommend/seek approval per governance (ECO Domain2 Task29)."},
      {id:60,q:"Communicate intended direction and linkage between org strategies and planned work. What will you use?",options:[
        {k:'A',text:'Program business case.'},
        {k:'B',text:'Program roadmap'},
        {k:'C',text:'Program charter.'},
        {k:'D',text:'Program risk register.'}
      ],answer:'B',explanation:"Program roadmap depicts intended direction, dependencies, milestones, and strategy-to-work linkage (Standard p.36)."},
      {id:61,q:"Need understand financial environment for early funding activities. What should you do?",options:[
        {k:'A',text:"Develop the program's financial framework."},
        {k:'B',text:'Compare costs to expected benefits realization.'},
        {k:'C',text:'Develop a budget based on historical information.'},
        {k:'D',text:'Take the funding from the sponsor.'}
      ],answer:'A',explanation:"Financial framework coordinates funding flows, constraints, and allocation for program duration (Standard p.114)."},
      {id:62,q:"Delivery phase; many projects transitioned. PM escalates a risk to program team. What should be done?",options:[
        {k:'A',text:'Mitigate before incorporated into risk plan.'},
        {k:'B',text:'Document in transition plan as potential issue.'},
        {k:'C',text:'Incorporate into risk register and perform thorough analysis.'},
        {k:'D',text:'Document in issue log and immediately notify steering committee.'}
      ],answer:'C',explanation:"First step: add escalated risk to risk register then analyze and assign response."},
      {id:63,q:"New strategy: cloud transition. To plan program success, what should PM do to engage stakeholders (first)?",options:[
        {k:'A',text:'Identify expectations and outline indicators/benefits; create framework for ongoing activities.'},
        {k:'B',text:'Outline how all stakeholders will be engaged using register/plan.'},
        {k:'C',text:'Document, prioritize, and track issues.'},
        {k:'D',text:'Understand organizational culture and politics, overall program impact, and program-related stakeholder concerns.'}
      ],answer:'D',explanation:"First step is stakeholder analysis context: understand culture/politics/concerns and overall impact (Standard p.62; ECO Domain4 Task2)."},
      {id:64,q:"Lowest-price best-schedule bidder not prequalified; relative to a PM; meets policies; concerned about conflict. What do you do?",options:[
        {k:'A',text:'Insert bidder in list and replace PM.'},
        {k:'B',text:'Choose best bid from prequalified list.'},
        {k:'C',text:'Choose bid and document decision.'},
        {k:'D',text:'Advise the sponsor of a potential conflict of interest before awarding the bid.'}
      ],answer:'D',explanation:"Potential conflict of interest: disclose/advise sponsor before award; ensure ethical decision."},
      {id:65,q:"Used lessons learned repository to fix duplicated customer data; corrective action implemented. What do you do with knowledge gained?",options:[
        {k:'A',text:'Add lessons learned to monthly report.'},
        {k:'B',text:'Update the lessons learned database.'},
        {k:'C',text:'Add lessons learned to communications plan.'},
        {k:'D',text:'Submit corrective action to steering committee.'}
      ],answer:'B',explanation:"Lessons learned are organizational assets; update repository/database (Standard p.130)."},
      {id:66,q:"Program near completion; ops staff concerned benefits won’t be fully realized. Avoid such concerns in future?",options:[
        {k:'A',text:'Send capabilities benefits to ops staff.'},
        {k:'B',text:'Update risk register and assign responses.'},
        {k:'C',text:"Develop program benefits transition plan for ops area's readiness."},
        {k:'D',text:'Collaborate with ops staff to develop program benefits sustainment plan.'}
      ],answer:'D',explanation:"Sustainment plan defines processes/metrics/tools beyond completion; collaborate with receiving org to ensure continued realization (ECO Domain3 Task3)."},
      {id:67,q:"Phase gate reviews have excellent feedback; customer wants to stop them. What do you do?",options:[
        {k:'A',text:'Ask recommendations from stakeholders.'},
        {k:'B',text:'Don’t stop periodic phase gate reviews to maintain effectiveness for benefits realization.'},
        {k:'C',text:'Follow customer and submit change control.'},
        {k:'D',text:'Use periodic comms report instead.'}
      ],answer:'B',explanation:"Governance requires periodic reviews at key decision points to approve continuation/changes (Standard p.75)."},
      {id:68,q:"Contract with company Y; QA finds server issue due to enhancements; need additional funding/resources. Next most important step?",options:[
        {k:'A',text:'Arrange funding/resources from canceled projects.'},
        {k:'B',text:'Inform company Y funding/resources unavailable.'},
        {k:'C',text:'Follow the integrated change control process.'},
        {k:'D',text:'Use program management reserve.'}
      ],answer:'C',explanation:"Requesting additional time/cost/scope requires integrated change control and approval."},
      {id:69,q:"Matrix org; high tech projects; using time reporting to avoid overruns. Critical component of program schedule management process?",options:[
        {k:'A',text:'Activity/component start & finish dates and intermediate milestones.'},
        {k:'B',text:'A list of all the projects.'},
        {k:'C',text:'Training time for all team members and PMs.'},
        {k:'D',text:'Project team members and PM skill levels.'}
      ],answer:'A',explanation:"Program master schedule identifies component order, start/end dates, interdependencies, and later intermediate milestones (Standard p.121)."},
      {id:70,q:"Benefits register should include which?",options:[
        {k:'A',text:'Planned benefits list, EV, and responsible stakeholder.'},
        {k:'B',text:'Planned benefits list, realization date, and creator.'},
        {k:'C',text:'Planned benefits list, components mapping, and measurement method.'},
        {k:'D',text:'Planned benefits list, stakeholders, and program management plan.'}
      ],answer:'C',explanation:"Benefits register: planned benefits, mapping to components/roadmap, and how each benefit will be measured (Standard p.47)."},
      {id:71,q:"Preparing business case for global branch transition; what should be included?",options:[
        {k:'A',text:'Inventory and employee details.'},
        {k:'B',text:'Interdependencies between the projects.'},
        {k:'C',text:'A cost/benefit analysis of the different scenarios and their respective contributions.'},
        {k:'D',text:'Compensation packages for all countries.'}
      ],answer:'C',explanation:"Business case includes cost-benefit and alternative solutions/scenarios contributing to outcomes (Standard p.35)."},
      {id:72,q:"System delivered; after 3 months quality/accuracy insufficient; beneficiaries request follow-up process. Which defines that process?",options:[
        {k:'A',text:'Benefits register.'},
        {k:'B',text:'Benefits sustainment plan.'},
        {k:'C',text:'Benefits transition plan.'},
        {k:'D',text:'Benefits report.'}
      ],answer:'B',explanation:"Sustainment plan defines ongoing monitoring/metrics/tools to ensure continued benefit realization (Standard p.55)."},
      {id:73,q:"Project faces emerging risks; you fell behind reviewing/approving plans so PM can’t address effectively. What should you do?",options:[
        {k:'A',text:'Assign resolution responsibility of project-level risks to the project manager.'},
        {k:'B',text:'Ask PM to cancel the project.'},
        {k:'C',text:'Create risk escalation policies/procedures in risk response plan.'},
        {k:'D',text:'Ignore the risks.'}
      ],answer:'A',explanation:"Project-level risk execution is PM’s responsibility; program risk mgmt handles escalated/interdependency risks (Standard p.98)."},
      {id:74,q:"Closing procedure; after presenting realized benefits to governance board, what do you do next?",options:[
        {k:'A',text:'Develop integration management plan.'},
        {k:'B',text:'Start transitioning program resources and plans.'},
        {k:'C',text:'Get sponsoring organization approval to begin closeout procedures to transition benefits sustainment to supporting organization.'},
        {k:'D',text:'Update contract management plan and archive.'}
      ],answer:'C',explanation:"After transition activities, obtain approval from sponsoring org to formally close and transition sustainment responsibility (Standard p.97)."},
      {id:75,q:"CMC System program; sales already selected technology. What should you do to ensure success?",options:[
        {k:'A',text:'Conduct kickoff, gather requirements, design session, then meet steering committee with solution meeting requirements.'},
        {k:'B',text:'Meet CEO to discuss risks before requirements analyzed.'},
        {k:'C',text:'Ask team to act as sponsor and get approval on chosen solution.'},
        {k:'D',text:'Issue RFQ to select solution and gain approval from sales.'}
      ],answer:'A',explanation:"Start with kickoff/requirements/design and then governance decision on solution; don’t lock solution before requirements."},
      {id:76,q:"Program near end; PM terminated; new PM assigned; last project completes in 5 days. What should new PM do prior to closure?",options:[
        {k:'A',text:'Review/update benefits plan to ensure first project meets expectations.'},
        {k:'B',text:'Determine with sponsor who is responsible for benefits sustainment, and identify measures from benefits plan to measure success.'},
        {k:'C',text:'Request immediate closing from steering committee.'},
        {k:'D',text:'Document lessons learned and prepare mitigation strategies.'}
      ],answer:'B',explanation:"Before closure, confirm sustainment responsibility and measures to monitor continued benefits (ECO Domain3 Task3)."},
      {id:77,q:"Planning phase; project schedules will merge into program master schedule. What should you do to ensure lifecycle meets expectations/delivers benefits?",options:[
        {k:'A',text:'Develop a review of the project schedules.'},
        {k:'B',text:'Decompose the project schedules to minimize risk.'},
        {k:'C',text:'Develop a program WBS to align execution with stakeholder expectations and benefits management plan.'},
        {k:'D',text:'Decompose component schedules to accelerate execution.'}
      ],answer:'C',explanation:"Program WBS frames scope and links components to objectives/benefits; basis for master schedule, cost estimates, and control points (Standard p.123)."},
      {id:78,q:"Project has many change requests; may delay milestones; insufficient skilled resources. How handle the risk?",options:[
        {k:'A',text:'Prioritize critical resources and update roadmap.'},
        {k:'B',text:'Stop change requests until milestones completed and update risk register.'},
        {k:'C',text:'Add risk to issue log.'},
        {k:'D',text:'Prioritize change requests via impact analysis; resource only critical ones until delayed milestones achieved; update risk register.'}
      ],answer:'D',explanation:"Prioritize changes and allocate scarce skills to critical work; treat as risk and update risk register."},
      {id:79,q:"Completed benefits analysis and planning activities. What will that provide to the program?",options:[
        {k:'A',text:'Information to establish key benefits KPIs.'},
        {k:'B',text:'Sustainment plan.'},
        {k:'C',text:'Benefits management plan to guide the work through the remainder of the program.'},
        {k:'D',text:'Transition plan.'}
      ],answer:'C',explanation:"Benefits analysis/planning phase outputs benefits management plan and metrics framework (Standard p.48-50)."},
      {id:80,q:"Large program; assigned PMs; continue to develop program team. What is your strategy?",options:[
        {k:'A',text:'Assign PMs responsibility of risks between projects.'},
        {k:'B',text:'Motivate PMs to share expertise.'},
        {k:'C',text:'Motivate PMs for more responsibilities.'},
        {k:'D',text:'Train and coach the project managers to manage project resources.'}
      ],answer:'D',explanation:"Develop team via training/coaching of PMs on resource management to strengthen delivery."},
      {id:81,q:"Water/wastewater program; business case approved. What should PM do next?",options:[
        {k:'A',text:'Develop transition plan.'},
        {k:'B',text:'Develop a program charter.'},
        {k:'C',text:'Develop the program management plan.'},
        {k:'D',text:'Develop the final report.'}
      ],answer:'B',explanation:"Business case is input to program charter and then roadmap (Standard p.34)."},
      {id:82,q:"Select program based on 3-year ROI solely. Which selected?",options:[
        {k:'A',text:'Program-1 (cost 500k, annual inflow 150k).'},
        {k:'B',text:'Program-2 (cost 300k, annual inflow 110k).'},
        {k:'C',text:'Program-3 (cost 200k, annual inflow 90k).'},
        {k:'D',text:'Program-4 (cost 400k, annual inflow 70k).'}
      ],answer:'C',explanation:"ROI over 3 years: P1=-10%, P2=10%, P3=35%, P4=-47.5%. Highest ROI is Program-3."},
      {id:83,q:"Project scheduled to close in 4 days. What verify prior to allowing project closure?",options:[
        {k:'A',text:'Verify project met/exceeded benefits realization criteria to meet program objectives.'},
        {k:'B',text:'Verify project released resources to achieve objectives.'},
        {k:'C',text:'Verify financial requirements met.'},
        {k:'D',text:'Verify procurement met program objectives.'}
      ],answer:'A',explanation:"Verify close/transition meets benefit realization criteria to achieve strategic objectives (ECO Domain3 Task5)."},
      {id:84,q:"Leaders listed benefits and want when incremental benefits realized. What should you do first?",options:[
        {k:'A',text:'Develop transition plan.'},
        {k:'B',text:'Develop program schedule.'},
        {k:'C',text:'Develop program management plan.'},
        {k:'D',text:'Develop the program roadmap.'}
      ],answer:'D',explanation:"In formulation: build high-level roadmap with milestones to validate/approve direction (ECO Domain1 Task2)."},
      {id:85,q:"Program started and preparation completed. In which phase are component projects planned?",options:[
        {k:'A',text:'Program delivery phase.'},
        {k:'B',text:'Program definition phase.'},
        {k:'C',text:'Program transition phase.'},
        {k:'D',text:'Program planning phase.'}
      ],answer:'A',explanation:"During delivery, components go through authorization/planning, oversight/integration, and transition/closure (Standard p.95)."},
      {id:86,q:"CRM transformation; new integration request approved as new scope with funding. What do you do next?",options:[
        {k:'A',text:'Approval from key stakeholders'},
        {k:'B',text:'Assign a new project manager to the new project.'},
        {k:'C',text:'Close an existing project to reassign all resources.'},
        {k:'D',text:'Prioritize the existing program components to ensure optimal resource allocation and management of interdependencies.'}
      ],answer:'D',explanation:"After scope approval, next is optimize resource allocation and manage interdependencies by prioritizing components (resource interdependency management)."},
      {id:87,q:"Program objectives impact population; public orgs comment negatively. What should you do first?",options:[
        {k:'A',text:'Update stakeholder engagement plan.'},
        {k:'B',text:'Perform risk of negative media coverage.'},
        {k:'C',text:'Review stakeholder register to determine ability of these stakeholders to affect outcomes.'},
        {k:'D',text:'Meet governance board to discuss problem.'}
      ],answer:'C',explanation:"First assess stakeholder influence/impact via stakeholder register; then plan engagement/risk responses (Standard p.57)."},
      {id:88,q:"What provides program/components status, cost info, risk analysis, etc.?",options:[
        {k:'A',text:'Communications log.'},
        {k:'B',text:'Program performance report.'},
        {k:'C',text:'Program communications management plan.'},
        {k:'D',text:'Information gathering techniques.'}
      ],answer:'B',explanation:"Program performance reports consolidate status, EV, risks/issues/changes and whether goals/benefits will be met (Standard p.101)."},
      {id:89,q:"10-project program; first 5 projects have many change orders and resource/risk issues. What should you do to keep second 5 on track?",options:[
        {k:'A',text:'Develop a change management strategy.'},
        {k:'B',text:'Update the program management plan.'},
        {k:'C',text:'Update the baseline of the second 5 projects.'},
        {k:'D',text:'Meet with the project managers weekly.'}
      ],answer:'A',explanation:"Use change management strategy to control scope/schedule/cost/quality/risks across program (ECO Domain2 Task28)."}
    ];

    const els = {
      quiz: document.getElementById('quiz'),
      qCount: document.getElementById('qCount'),
      startBtn: document.getElementById('startBtn'),
      submitBtn: document.getElementById('submitBtn'),
      resetBtn: document.getElementById('resetBtn'),
      status: document.getElementById('status'),
      score: document.getElementById('score'),
      total: document.getElementById('total'),
      grade: document.getElementById('grade'),
      answered: document.getElementById('answered'),
      timerPill: document.getElementById('timerPill'),
      timer: document.getElementById('timer'),
      timeUsed: document.getElementById('timeUsed'),
      onlyIncorrect: document.getElementById('onlyIncorrect'),
      search: document.getElementById('search'),
      expandAll: document.getElementById('expandAll'),
      collapseAll: document.getElementById('collapseAll'),
      scrollTop: document.getElementById('scrollTop'),
      printBtn: document.getElementById('printBtn'),
      customMin: document.getElementById('customMin'),
      applyCustom: document.getElementById('applyCustom'),
      pauseBtn: document.getElementById('pauseBtn'),
      add1Btn: document.getElementById('add1Btn'),
      add5Btn: document.getElementById('add5Btn'),
    };

    const state = {
      durationSec: 45 * 60,
      startedAt: null,
      endsAt: null,
      remainingSec: null, // used when paused
      paused: false,
      timerHandle: null,
      submitted: false,
      answers: {}, // { [id]: 'A'|'B'|'C'|'D' }
      autoSubmitted: false,
    };

    function save() {
      const payload = {
        durationSec: state.durationSec,
        startedAt: state.startedAt,
        endsAt: state.endsAt,
        remainingSec: state.remainingSec,
        paused: state.paused,
        submitted: state.submitted,
        answers: state.answers,
      };
      localStorage.setItem(QUIZ_ID, JSON.stringify(payload));
    }

    function load() {
      try {
        const raw = localStorage.getItem(QUIZ_ID);
        if (!raw) return;
        const payload = JSON.parse(raw);
        if (payload && typeof payload === 'object') {
          state.durationSec = payload.durationSec ?? state.durationSec;
          state.startedAt = payload.startedAt ?? null;
          state.endsAt = payload.endsAt ?? null;
          state.remainingSec = payload.remainingSec ?? null;
          state.paused = payload.paused ?? false;
          state.submitted = payload.submitted ?? false;
          state.answers = payload.answers ?? {};
        }
      } catch (e) {
        // ignore
      }
    }

    function fmtTime(sec) {
      sec = Math.max(0, Math.floor(sec));
      const m = Math.floor(sec / 60);
      const s = sec % 60;
      return `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    }

    function computeGrade() {
      const total = questions.length;
      let correct = 0;
      let answered = 0;
      for (const q of questions) {
        const a = state.answers[q.id];
        if (a) answered++;
        if (a && a === q.answer) correct++;
      }
      return { total, correct, answered, pct: total ? (correct/total)*100 : 0 };
    }

    function letterBadge(letter, variant='slate') {
      const styles = {
        slate: 'bg-slate-100 text-slate-900',
        green: 'bg-emerald-100 text-emerald-900',
        red: 'bg-rose-100 text-rose-900',
        indigo: 'bg-indigo-100 text-indigo-900',
      };
      return `<span class="inline-flex h-6 w-6 items-center justify-center rounded-full text-xs font-bold ${styles[variant]||styles.slate}">${letter}</span>`;
    }

    function buildQuestionCard(q) {
      const selected = state.answers[q.id] || '';
      const isSubmitted = state.submitted;
      const isCorrect = selected && selected === q.answer;
      const isWrong = isSubmitted && (!selected || selected !== q.answer);

      const visibleByIncorrect = !els.onlyIncorrect.checked || (isSubmitted && !isCorrect);
      const searchTerm = (els.search.value || '').trim().toLowerCase();
      const matchesSearch = !searchTerm || q.q.toLowerCase().includes(searchTerm) || q.options.some(o => o.text.toLowerCase().includes(searchTerm));
      const shouldShow = visibleByIncorrect && matchesSearch;

      const headerClasses = isSubmitted
        ? (isCorrect ? 'border-emerald-200 bg-emerald-50' : 'border-rose-200 bg-rose-50')
        : 'border-slate-200 bg-white';

      const statusPill = isSubmitted
        ? (isCorrect
            ? `<span class="rounded-full bg-emerald-600 px-2 py-1 text-xs font-semibold text-white">Correct</span>`
            : `<span class="rounded-full bg-rose-600 px-2 py-1 text-xs font-semibold text-white">Incorrect</span>`)
        : (selected
            ? `<span class="rounded-full bg-slate-900 px-2 py-1 text-xs font-semibold text-white">Answered</span>`
            : `<span class="rounded-full bg-slate-200 px-2 py-1 text-xs font-semibold text-slate-700">Unanswered</span>`);

      const optionsHtml = q.options.map(o => {
        const checked = selected === o.k;

        const showKey = isSubmitted;
        const isRightOption = isSubmitted && o.k === q.answer;
        const isChosenWrong = isSubmitted && checked && o.k !== q.answer;

        let rowCls = 'border-slate-200 bg-white';
        if (isRightOption) rowCls = 'border-emerald-200 bg-emerald-50';
        if (isChosenWrong) rowCls = 'border-rose-200 bg-rose-50';

        const leftBadge = isSubmitted
          ? (isRightOption ? letterBadge(o.k,'green') : (isChosenWrong ? letterBadge(o.k,'red') : letterBadge(o.k,'slate')))
          : letterBadge(o.k,'slate');

        const rightTag = isSubmitted
          ? (isRightOption ? `<span class="text-xs font-semibold text-emerald-700">Correct answer</span>`
            : (isChosenWrong ? `<span class="text-xs font-semibold text-rose-700">Your choice</span>` : ''))
          : (checked ? `<span class="text-xs font-semibold text-indigo-700">Selected</span>` : '');

        const disabled = isSubmitted ? 'disabled' : '';

        return `
          <label class="flex cursor-pointer items-start justify-between gap-3 rounded-xl border p-3 ${rowCls}">
            <div class="flex items-start gap-3">
              ${leftBadge}
              <div>
                <div class="text-sm font-medium text-slate-900">${o.text}</div>
                ${showKey ? `<div class="mt-1 text-xs text-slate-500">Option ${o.k}</div>` : ''}
              </div>
            </div>
            <div class="flex items-center gap-3">
              ${rightTag}
              <input ${disabled} type="radio" name="q_${q.id}" value="${o.k}" ${checked ? 'checked' : ''} class="mt-1 h-4 w-4" />
            </div>
          </label>
        `;
      }).join('');

      const explainOpen = isSubmitted ? 'open' : '';
      const explainHtml = `
        <details class="mt-3 rounded-xl border border-slate-200 bg-white p-3" ${explainOpen}>
          <summary class="cursor-pointer select-none text-sm font-semibold text-slate-900">Explanation</summary>
          <div class="mt-2 text-sm text-slate-700 prose-ish">
            <p><span class="font-semibold">Correct answer:</span> ${q.answer}</p>
            ${selected ? `<p><span class="font-semibold">Your answer:</span> ${selected}</p>` : `<p><span class="font-semibold">Your answer:</span> (unanswered)</p>`}
            <p class="mt-2">${q.explanation}</p>
          </div>
        </details>
      `;

      return `
        <article data-qid="${q.id}" class="print-break ${shouldShow ? '' : 'hidden'} rounded-2xl border ${headerClasses} p-4 ring-soft">
          <div class="flex items-start justify-between gap-3">
            <div>
              <div class="flex flex-wrap items-center gap-2">
                <span class="rounded-full bg-slate-900 px-2 py-1 text-xs font-semibold text-white">Q${q.id}</span>
                ${statusPill}
              </div>
              <h3 class="mt-2 text-base font-semibold leading-snug">${q.q}</h3>
            </div>
            <a href="#" class="no-print text-xs font-semibold text-indigo-700 hover:underline" data-jump="${q.id}">Link</a>
          </div>
          <div class="mt-3 grid gap-2">${optionsHtml}</div>
          ${isSubmitted ? explainHtml : ''}
          ${isWrong ? `<div class="mt-3 rounded-xl border border-rose-200 bg-rose-50 p-3 text-sm text-rose-900"><span class="font-semibold">Correction:</span> The correct answer is <span class="font-bold">${q.answer}</span>.</div>` : ''}
        </article>
      `;
    }

    function render() {
      els.qCount.textContent = String(questions.length);
      els.total.textContent = String(questions.length);

      els.quiz.innerHTML = questions.map(buildQuestionCard).join('');

      // Attach radio listeners
      els.quiz.querySelectorAll('input[type="radio"]').forEach(input => {
        input.addEventListener('change', (e) => {
          const name = e.target.name; // q_ID
          const id = Number(name.split('_')[1]);
          state.answers[id] = e.target.value;
          save();
          if (!state.submitted) {
            // Lightweight re-render to update answered pills
            render();
            restoreScrollToQuestion(id);
          }
        });
      });

      // Link buttons
      els.quiz.querySelectorAll('[data-jump]').forEach(a => {
        a.addEventListener('click', (e) => {
          e.preventDefault();
          const id = Number(a.getAttribute('data-jump'));
          const el = els.quiz.querySelector(`[data-qid="${id}"]`);
          if (el) el.scrollIntoView({behavior:'smooth', block:'start'});
        });
      });

      // Update results section if submitted
      if (state.submitted) {
        const r = computeGrade();
        els.status.classList.remove('hidden');
        els.score.textContent = String(r.correct);
        els.grade.textContent = `${r.pct.toFixed(1)}%`;
        els.answered.textContent = String(r.answered);
      } else {
        els.status.classList.add('hidden');
      }

      els.submitBtn.disabled = !state.startedAt || state.submitted;
      const running = !!state.startedAt && !state.submitted;
      els.pauseBtn.disabled = !running;
      els.add1Btn.disabled = !running;
      els.add5Btn.disabled = !running;
      els.pauseBtn.textContent = state.paused ? 'Resume' : 'Pause';

      // Timer pill
      if (state.startedAt && !state.submitted) {
        els.timerPill.classList.remove('hidden');
        els.timerPill.classList.add('flex');
      } else {
        els.timerPill.classList.add('hidden');
        els.timerPill.classList.remove('flex');
      }
    }

    function restoreScrollToQuestion(id) {
      // Keep user near their last interaction on re-render.
      const el = document.querySelector(`[data-qid="${id}"]`);
      if (el) el.scrollIntoView({behavior:'instant', block:'center'});
    }

    function startTimer() {
      if (state.timerHandle) clearInterval(state.timerHandle);
      state.startedAt = Date.now();
      state.remainingSec = null;
      state.paused = false;
      state.endsAt = state.startedAt + state.durationSec * 1000;
      state.submitted = false;
      state.autoSubmitted = false;
      save();

      state.timerHandle = setInterval(tickTimer, 250);
      tickTimer();
      render();

      // Move user to first question
      setTimeout(() => {
        const first = document.querySelector('[data-qid="1"]');
        if (first) first.scrollIntoView({behavior:'smooth', block:'start'});
      }, 50);
    }

    function stopTimer() {
      if (state.timerHandle) clearInterval(state.timerHandle);
      state.timerHandle = null;
    }

    function togglePause() {
      if (!state.startedAt || state.submitted) return;
      if (!state.paused) {
        // pause
        state.remainingSec = getRemainingSec();
        state.paused = true;
      } else {
        // resume
        const rem = Math.max(0, Math.floor(state.remainingSec ?? 0));
        state.paused = false;
        state.remainingSec = null;
        state.endsAt = Date.now() + rem * 1000;
      }
      save();
      tickTimer();
      render();
    }

    function addTime(min) {
      if (!state.startedAt || state.submitted) return;
      const rem = getRemainingSec();
      applyRemainingSec(rem + min * 60);
    }

    function getRemainingSec() {
      if (!state.startedAt) return null;
      if (state.submitted) return 0;
      if (state.paused) return Math.max(0, Math.floor(state.remainingSec ?? 0));
      const now = Date.now();
      const remaining = Math.max(0, state.endsAt - now);
      return Math.max(0, Math.ceil(remaining / 1000));
    }

    function applyRemainingSec(newRemainingSec) {
      newRemainingSec = Math.max(0, Math.floor(newRemainingSec));
      if (!state.startedAt || state.submitted) return;

      if (state.paused) {
        state.remainingSec = newRemainingSec;
      } else {
        state.endsAt = Date.now() + newRemainingSec * 1000;
      }
      save();
      tickTimer();
      render();
    }

    function tickTimer() {
      if (!state.startedAt || state.submitted) return;

      const remainingSec = getRemainingSec();
      els.timer.textContent = fmtTime(remainingSec);

      // warning styles
      const pill = els.timerPill;
      pill.classList.remove('bg-slate-900','bg-amber-600','bg-rose-600');
      if (state.paused) pill.classList.add('bg-slate-900');
      else if (remainingSec <= 60) pill.classList.add('bg-rose-600');
      else if (remainingSec <= 5*60) pill.classList.add('bg-amber-600');
      else pill.classList.add('bg-slate-900');

      if (!state.paused && remainingSec <= 0) {
        state.autoSubmitted = true;
        submit();
      }
    }

    function computeTimeUsed() {
      if (!state.startedAt) return 0;
      const end = state.submitted ? (state._submittedAt || Date.now()) : Date.now();
      return Math.max(0, Math.round((end - state.startedAt)/1000));
    }

    function submit() {
      if (state.submitted) return;
      state.submitted = true;
      state._submittedAt = Date.now();
      stopTimer();
      save();

      // Results summary
      const used = computeTimeUsed();
      els.timeUsed.textContent = fmtTime(used);

      render();

      // Expand to results
      setTimeout(() => {
        document.getElementById('status').scrollIntoView({behavior:'smooth', block:'start'});
      }, 50);

      // If auto-submitted, show message
      if (state.autoSubmitted) {
        const note = document.createElement('div');
        note.className = 'no-print mt-4 rounded-2xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900 ring-soft';
        note.innerHTML = '<span class="font-semibold">Time is up.</span> The quiz was auto-submitted.';
        const status = document.getElementById('status');
        status.appendChild(note);
      }
    }

    function resetAll() {
      stopTimer();
      state.startedAt = null;
      state.endsAt = null;
      state.submitted = false;
      state.answers = {};
      state.autoSubmitted = false;
      delete state._submittedAt;
      localStorage.removeItem(QUIZ_ID);
      els.timer.textContent = '--:--';
      els.timeUsed.textContent = '--:--';
      els.search.value = '';
      els.onlyIncorrect.checked = false;
      render();
      document.getElementById('intro').scrollIntoView({behavior:'smooth', block:'start'});
    }

    // Controls
    document.querySelectorAll('.durBtn').forEach(btn => {
      btn.addEventListener('click', () => {
        const min = Number(btn.getAttribute('data-min'));
        if (!Number.isFinite(min) || min <= 0) return;
        state.durationSec = min * 60;
        els.customMin.value = String(min);
        save();
      });
    });

    els.applyCustom.addEventListener('click', () => {
      const min = Number(els.customMin.value);
      if (!Number.isFinite(min) || min <= 0) return;
      state.durationSec = Math.floor(min * 60);
      save();
    });

    els.startBtn.addEventListener('click', () => {
      // If already started and not submitted, confirm restart
      if (state.startedAt && !state.submitted) {
        if (!confirm('Restart timer? Your selected answers will be kept.')) return;
      }
      startTimer();
    });

    els.submitBtn.addEventListener('click', () => {
      if (!confirm('Submit and grade your answers now?')) return;
      submit();
    });

    els.resetBtn.addEventListener('click', () => {
      if (!confirm('Reset the quiz and clear all saved answers?')) return;
      resetAll();
    });

    els.pauseBtn.addEventListener('click', () => {
      togglePause();
    });

    els.add1Btn.addEventListener('click', () => addTime(1));
    els.add5Btn.addEventListener('click', () => addTime(5));

    els.onlyIncorrect.addEventListener('change', render);
    els.search.addEventListener('input', render);

    els.expandAll.addEventListener('click', () => {
      document.querySelectorAll('#quiz details').forEach(d => d.open = true);
    });
    els.collapseAll.addEventListener('click', () => {
      document.querySelectorAll('#quiz details').forEach(d => d.open = false);
    });

    els.scrollTop.addEventListener('click', () => {
      window.scrollTo({top:0, behavior:'smooth'});
    });

    els.printBtn.addEventListener('click', () => window.print());

    // Init
    load();

    // If timer was running previously, resume it
    if (state.startedAt && state.endsAt && !state.submitted) {
      state.timerHandle = setInterval(tickTimer, 250);
      tickTimer();
    } else {
      els.timer.textContent = '--:--';
    }

    // If submitted, compute time used based on duration
    if (state.submitted && state.startedAt) {
      const used = Math.min(state.durationSec, Math.max(0, Math.round(((state._submittedAt || Date.now()) - state.startedAt)/1000)));
      els.timeUsed.textContent = fmtTime(used);
    }

    render();
  </script>
</body>
</html>
